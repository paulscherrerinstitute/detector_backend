CC=gcc

LIBNAME=libudpreceiver
LIBDIR=$(shell find `python -c "from distutils.sysconfig import get_python_lib; print get_python_lib()"` -name libringbuffer.so | sed "s:libringbuffer.so::g")

#LIBDIR=/home/dbe/ringbuffer/ringbuffer/lib/
LIBDIR=/home/sala/Work/GIT/psi/HPDI/ringbuffer/ringbuffer/lib
CFLAGS=-I../ringbuffer/src/ -L$(LIBDIR) -Wl,-rpath=$(LIBDIR) -lringbuffer -Wall

DEBUG?=0
ifeq ($(DEBUG), 1)
	CFLAGS += -DDEBUG
endif

all: src/udp_receiver.c
	$(info $(CFLAGS))
	$(CC) -shared -march=core-avx2 -fPIC -O2 $(CFLAGS) -o $(LIBNAME).so  $? -lringbuffer
